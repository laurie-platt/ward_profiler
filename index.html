<!DOCTYPE html>
<html lang="en-GB">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
  <meta charset="utf-8">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans|Roboto"/>
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.10/css/all.css" integrity="sha384-+d0P83n9kaQMCwj8F4RJB66tzIwOKmrdb46+porD/OvrJ+37WqIM7UoBtwHO6Nlg" crossorigin="anonymous">
  <title id="pageTitle">Sheffield ward profiler</title>
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-legend/2.24.0/d3-legend.js"></script>
  <script src="assets/labGetQryStrValByKey.js"></script>
  <script src="d3/choropleth.js"></script>
  <script src="d3/lollypopChart.js"></script>
  <style>
  a
  {
    color: #fc6721;
    text-decoration: none;
  }
  a:hover
  {
    text-decoration: underline;
  }
  h3
  {
    color: #757575;
    padding-top:0px;
    margin:0;
  }
  @font-face
  {
    font-family: 'Roboto', sans-serif;
    src: url("https://fonts.googleapis.com/css?family=Open+Sans|Roboto'");
  }
  h3, .placeLabel, .legend, .legendTitle, #bestFitLegend, #datasetDescription, #description, #download,
  .header, .choroTitle, .choroSubtitle, .choroSource, .choroNote, .valueLabel, .tickLabel
  {
    font-family: 'Roboto', sans-serif;
  }
  .header
  {
    font-size: 20px;
    color: #757575;
    cursor: pointer;
  }
  #headerTitle
  {
    float: left;
    display: inline-block;
    padding-top: 10px;
    padding-left: 10px;
    vertical-align: text-bottom;
  }
  #main
  {
    border-top: 1px solid #ccc;
  }
  #bestFitMap
  {
    max-width: 100%;
    position: fixed;
    top: 10px;
    left: 10px;
    right:10px;
    bottom:10px;
    background-color: white;
    overflow-y: auto;
    padding: 0 30px 0 12px;
    box-shadow: 0px 0px 3px 3px #757575;
  }
  #closeBotton
  {
    position: fixed;
    top: 15px;
    left: 20px;
    font-size: 25px;
    color: #757575;
    text-align: center;
    cursor: pointer;
  }
  .boundary
  {
    fill: white;
    stroke: #757575;
    stroke-opacity: 0.5;
    stroke-width: 1px;
    stroke-linejoin: round;
  }
  .circle{
    stroke:#757575;
  }
  .tickLabel{
    fill:#757575;
  }
  .legend
  {
    font-size: 11px;
    fill: #757575
  }
  .legendTitle
  {
    font-size: 12px;
    fill: #757575
  }
  #theme{
    float:left;
    padding: 10px 5px 10px 0px;
  }
  #dataset
  {
    float:left;
    padding-top: 10px;
    padding-bottom: 10px;
    overflow-x: hidden;
  }
  #mapContainer
  {
    width:50%;
    float:left;
    text-align: center;
  }
  #map, #bar
  {
    width: 90%;
    display: inline-block;
  }
  #barCointainer
  {
    width:50%;
    float:right;
    text-align: center;
  }
  #bestFitLegend
  {
    font-size: 12px;
    color: black;
    padding: 10px 3.3% 0px 3.3%;
  }
  #datasetDescription
  {
    font-size: 16px;
    color: black;
    clear: both;
    padding: 10px 3.3% 10px 3.3%;
  }
  #description
  {
    text-align: left;
    padding-right: 20px;
  }
  #description p
  {
    font-size: 12px;
  }
  #download
  {
    padding: 10px 3.3% 0px 3.3%;
    font-size: 12px;
  }
  .labButton
{
    background-color: #757575;
    color: #fff;
    padding: 3px 5px 3px 5px;
    margin: 0 0 7px 10px;
    border-radius: 3px;
    display: inline-block;
}

.labButton:hover
{
    cursor: pointer;
    background-color: #fc6721;
    text-decoration: none;
}
  .clearb
  {
    clear: both;
  }
  .hidden
  {
    display: none;
  }
  .visible
  {
    display:block;
  }
  .eight0
  {
    width: 90%;
    text-align: center;
  }
  _:-ms-fullscreen, :root #map, #bar{
    height:35vw;
  }
  @media (max-width:800px)
  {
    #mapContainer, #barCointainer
    {
      width:100%;
    }
    #map, #bar
    {
      width:100%;
    }
    #theme, #dataset
    {
      padding-top: 0px;
      padding-bottom: 0px;
      max-width: 100%;
    }
    #datasetSelect
    {
      max-width: 100%;
      text-overflow: ellipsis;
    }
    #bestFitLegend, #description
    {
      padding: 10px 0px 10px 0px;
    }
    #datasetDescription, #bestFitLegend, #download
    {
      padding-left: 0px;
    }
  }
  </style>

</head>

<body>
  <div class="header clearb">
    <div class="clearb" onclick="initialPage()">
      <div id="headerTitle" onclick="initialPage()">Sheffield ward profiler</div>
    </div>
  </div>
  <div id="main" class="clearb">
  <div id="theme"></div>
  <div id="dataset"></div>
  <div id="bestFitMap" class="hidden">
    <div id="closeBotton" onclick="removeBestFitMap()"><span class="fas fa-times"></span></div>
    <div id="svgBFM"></div>
  </div>
  <div class="clearb">
    <div id="datasetDescription" class="clearb"></div>
    <div id="mapContainer">
      <div id="map"></div>
    </div>
    <div id="barCointainer">
      <div id="description" class="clearb"></div>
      <div id="bar"></div>
    </div>
  </div>
  <div id="bestFitLegend" class="clearb hidden">Note: The figures displayed correspond to data aggregated from the <a onclick='showBestFitMap()'>best-fit LSOAs to the Ward</a> according to the ONS.</div>
  <div id="download" class="clearb"></div>
</div>
  <script type="text/javascript">

  debugger;
  
  window.onpopstate = function(event) {
    window.location.reload(true)
  };
  
  themeUrls=[{theme:"Communications", url:"https://sheffwardprofiler.azurewebsites.net/data/communications/meta.csv"},
  {theme:"Community safety", url:"https://sheffwardprofiler.azurewebsites.net/data/community_safety/meta.csv"},
  {theme:"Demographics", url:"https://sheffwardprofiler.azurewebsites.net/data/demographics/meta.csv"},
  {theme:"Deprivation", url:"https://sheffwardprofiler.azurewebsites.net/data/deprivation/meta.csv"},
  {theme:"Economy", url:"https://sheffwardprofiler.azurewebsites.net/data/economy/meta.csv"},
  {theme:"Education", url:"https://sheffwardprofiler.azurewebsites.net/data/education/meta.csv"},
  {theme:"Environment", url:"https://sheffwardprofiler.azurewebsites.net/data/environment/meta.csv"},
  {theme:"Governance", url:"https://sheffwardprofiler.azurewebsites.net/data/governance/meta.csv"},
  {theme:"Health", url:"https://sheffwardprofiler.azurewebsites.net/data/health/meta.csv"},
  {theme:"Housing", url:"https://sheffwardprofiler.azurewebsites.net/data/housing/meta.csv"},
  {theme:"Labour market", url:"https://sheffwardprofiler.azurewebsites.net/data/labour_market/meta.csv"},
  {theme:"Transport", url:"https://sheffwardprofiler.azurewebsites.net/data/transport/meta.csv"}]
  currentTheme = ""
  var currentDatasetList=[]
  //Load geojson and create the theme selector
  var geoJsonUrl="https://sheffwardprofiler.azurewebsites.net/spatial/sheffield_ward_super_generalised.geojson"
  d3.json(geoJsonUrl, function (error, json1) {
    json=json1;
    themeSelector()
    readURLData()
  })
  function themeSelector(){
    var selectTheme = '<select id="selectTheme" name="selectTheme" onChange="themeDataset(this.value)"><option value="{}">Select a Theme</option>';
    for (var i = 0; i < themeUrls.length; i++) {
      selectTheme += '<option value="' + i + '"';
      selectTheme += '>' + themeUrls[i].theme + '</option>';
    }
    selectTheme += '</select>';
    document.getElementById("theme").innerHTML = selectTheme;
  }

  //Create a selector with the datasets of the selected theme
  function themeDataset(val){
    var name = themeUrls[+val].theme
    var url = themeUrls[+val].url
    currentTheme=name;
    d3.csv(url, function(error, data) {
      currentDatasetList=data;
      popSelect(data,'dataset','callChoro')
    })
  }

  function popSelect(data,container,onChangeFun) {
    var select = '<select id="datasetSelect" name="selectDataset" onChange="' + onChangeFun + '(this.value)"><option value="{}">Select a ' + container + '</option>';
    for (var i = 0; i < data.length; i++) {
      select += '<option value="'+ i + '"';
      select += '>' + data[i].indicator + '</option>';
    }
    select += '</select>';
    document.getElementById(container).innerHTML = select;
  }

  //plot Choropleth and lollypop Chart
  function callChoro(index){
    if (index!= "{}"){
      var name = currentDatasetList[+index]["indicator"];
      var url = currentDatasetList[+index]["data"];
      var urlCode = currentDatasetList[+index]["code"];
      var geography = currentDatasetList[+index]["geography"];
      var description = currentDatasetList[+index]["description"]
      var source = currentDatasetList[+index]["source"]
      var period = currentDatasetList[+index]["period"]

      d3.csv(url, function(error, data) {
        if (geography == "Best-fit ward"){
          document.getElementById("bestFitLegend").classList.add("visible");
        }
        else if (geography == "Electoral ward"){
          document.getElementById("bestFitLegend").classList.remove("visible");
        }
        for (var i = 0; i < data.length; i++) {
          var code = data[i].area_code;
          var value = parseFloat(data[i].value);
          for (var j = 0; j < json.features.length; j++) {
            var jsonCode = json.features[j].properties.area_code;
            if (code == jsonCode) {
              json.features[j].properties.value = value;
              break;
            }
          }
        }
        document.getElementById("map").innerHTML=""
        document.getElementById("bar").innerHTML=""
        document.getElementById("description").innerHTML=""
        var objChoro={data:json,
          container:"#map",
          title:name,
          subtitle:period,
          clickFunction:highlightArea,
          legendTitle:data[1]['measure'],
          source:source,
          palette:["#feedde", "#fdbe85", "#fd8d3c", "#e6550d", "#a63603"]
        }
          choro(objChoro)
          var objLPC={data:data,
            container:"#bar",
            clickFunction:highlightArea,
            palette:["#feedde", "#fdbe85", "#fd8d3c", "#e6550d", "#a63603"]
          }
          lollypopChart(objLPC)
          document.getElementById("datasetDescription").innerHTML=description
          //create download button
          document.getElementById("download").innerHTML='Download  <a class="labButton" href="'+ url +'" download>Data</a><a class="labButton" href="'+ urlCode +'" download>R code</a>'
          document.getElementById("pageTitle").innerHTML="Sheffield ward profiler:"+name
          var newurl = window.location.protocol + "//" + window.location.host + window.location.pathname + '?theme=' + encodeURIComponent(currentTheme) + '&name=' + encodeURIComponent(name);
          window.history.pushState({path:newurl},'',newurl);
        })
      }
    }

    function highlightArea(b,d){

      var elems=document.getElementsByClassName("boundary")
      for (var i = 0; i<elems.length; i++) {
          elems[i].style.stroke= "#757575";
          elems[i].style.strokeWidth= "1px";
      }
      var elems=document.getElementsByClassName("circle")
      for (var i = 0; i<elems.length; i++) {
        elems[i].style.stroke= "#757575";
        elems[i].style.strokeWidth= "1px";
      }
      var elems=document.getElementsByClassName("tickLabel")
      for (var i = 0; i<elems.length; i++) {
        elems[i].style.fill = "#757575";
      }
      var elems=document.getElementsByClassName("stick")
      for (var i = 0; i<elems.length; i++) {
        elems[i].style.stroke = "#ccc";
      }

      var elems=document.getElementsByClassName(d.area_name)
      for (var i = 0; i<elems.length; i++) {
        if(elems[i].tagName=="path"){
          elems[i].style.stroke= "black";
          elems[i].style.strokeWidth= "3px";
          elems[i].parentNode.appendChild(elems[i])
        }
        if(elems[i].tagName=="text"){
          elems[i].style.fill= "black";
        }
        if(elems[i].tagName=="circle"){
          elems[i].style.stroke= "black";
          elems[i].style.strokeWidth= "3px";;
        }
        if(elems[i].tagName=="line"){
          elems[i].style.stroke= "black";
        }
      }
    }
    //load svg's of Wards and map selector
    function initialPage(){
      debugger;
      
      document.getElementById("pageTitle").innerHTML="Sheffield ward profiler"
      var newurl = window.location.protocol + "//" + window.location.host + window.location.pathname
      window.history.pushState({path:newurl},'',newurl);

      document.getElementById("selectTheme").selectedIndex = 0;
      document.getElementById('selectTheme').value = '{}';
      document.getElementById("map").innerHTML=""
      document.getElementById("dataset").innerHTML=""
      document.getElementById("datasetDescription").innerHTML=""
      document.getElementById("bestFitLegend").classList.remove("visible");
      document.getElementById("download").innerHTML=""

      var width = 600;
      var height = 560;
      var svg = d3.select("#map")
      .append("svg")
      .attr("viewBox", "0 0 " + width + " " + height)
      .attr("preserveAspectRatio", "xMinYMin meet")
      var projection = d3.geoMercator()
      .center([ -1.560085, 53.381129 ])
      .translate([width/2, height/2])
      .scale([width * 115]);
      var path = d3.geoPath()
      .projection(projection);
      svg.selectAll("path")
      .data(json.features)
      .enter()
      .append("path")
      .attr("d", path)
      .attr("class", function(d) {return "boundary " + d.properties.area_name} )
      .on("click", function(d) {
        d3.select(this).call(plotSVG,d.properties)
      })
      plotSVG([],{area_name:"Birley"})
    }

    function plotSVG(b,d){

      var elems=document.getElementsByClassName("boundary")
      for (var i = 0; i<elems.length; i++) {
        elems[i].style.fill= "white"
      }

      var elems=document.getElementsByClassName(d.area_name)
      for (var i = 0; i<elems.length; i++) {
        if(elems[i].tagName=="path"){
          elems[i].style.fill= "#fd8d3c";
          elems[i].parentNode.appendChild(elems[i])
        }
      }      var nameObj = {
      "Beauchief and Greenhill":{slugName:"Beauchief_and_Greenhill", description:"The suburban neighbourhoods of Beauchief, Chancet Wood and Greenhill lie on a hill above the River Sheaf that runs along the north west boundary of the ward. About a third of the ward is taken up by the grounds of Beauchief Abbey and Beauchief Hall. These include Ladies' Spring Wood, Parkbank Wood, Beauchief Park, and two golf courses. On the southern boundary of the ward are the housing estates of Lowedges, Batemoor and Jordanthorpe  with several new developments including Meadowhead Secondary School, Graves Leisure Centre, the FA’s St Georges Park and St James Retail Park."},

      "Beighton":{slugName:"Beighton", description:"The communities of Beighton, Hackenthorpe, Owlthrope and Sothall reside within this ward. Beighton is located in the Eastern part of the city; it lies on the border of Rotherham and covers a total area of 5.7Km². There is access to attractive woodland and scenery of Moss Valley surrounding Owlthorpe in the west, Rother Valley Country Park to the east, overlooked by Sothall and a playing field next to Eckington Road. Excellent transport links include the Supertram and the A57 Mosborough Parkway as well as access to the M1 at the Aston junction."},
      
      "Birley":{slugName:"Birley", description:"The Birley ward includes the districts of Base Green, Birley Estate, Charnock, Frecheville, Scowerdons and part of Hackenthorpe. It is located in the Southern-Eastern part of the city and covers an area of 5.1Km². There is access to green space at Birley Spa, Four Lane Ends and along the border with North East Derbyshire."},

      "Broomhill and Sharrow Vale":{slugName:"Broomhill_and_Sharrow_Vale", description:"The Broomhill and Sharrow Vale ward consists of the districts of Broomhill, Broomhall, Crookesmoor, Endcliffe, Sharrow Vale and Tapton Hill. This ward was created following the 2015 local Government boundary review out of parts of the old Broomhill, Central and Nether Edge wards. This ward covers an area of 2.7Km². Broomhill and Sharrow Vale is one of the wards that make up the Sheffield Central Parliamentary Constituency. This ward is popular among the student population due to its ideal location, situated closely to both Sheffield Hallam University and The University of Sheffield."},

      "Burngreave":{slugName:"Burngreave", description:"The Burngreave ward includes the districts of Burngreave, Fir Vale, Grimesthorpe, Pitsmoor, and Shirecliffe. It is located in the Northern area of the city and covers an area of 7.3km²."},

      "City":{slugName:"City", description:"Clifford is a small and densely populated ward at the north east tip of the Borough bordering Hulme in Manchester to the east and Whalley Range to the south. Physically it is characterised by dense residential areas of Victorian terraced housing and a diverse range of housing stock. Clifford is also known for its very diverse population, vibrant communities and active community groups, some are established and there are some newer groups. Clifford is undergoing significant transformation with the Old Trafford Master Plan and there is a lot of change to current housing."},

      "Crookes and Crosspool":{slugName:"Crookes_and_Crosspool", description:"Crookes and Crosspool ward includes the districts of Crookes, Steelbank, Crosspool, and Sandygate. It is located in the Western part of the city and covers an area of 3.9km²."},

      "Darnall":{slugName:"Darnall", description:"Davyhulme West is bounded by the Manchester Ship Canal to the west, Davyhulme waste water treatment works to the north and residential areas of Davyhulme and Flixton to the east and south. The ward is mainly residential with large areas of private open land along the canal edge and the Mersey Valley to the south east tip of the ward. Trafford General Hospital is located in this ward."},

      "Dore and Totley":{slugName:"Dore_and_Totley", description:"Flixton is bounded by the Mersey Valley and the River Mersey to the south and is traversed by the Manchester to Liverpool railway line. Its population is concentrated in areas in the northern half of the ward; other areas are generally open and include two golf courses (William Wroe and Flixton Golf Course)."},

      "East Ecclesfield":{slugName:"East_Ecclesfield", description:"Gorse Hill is the northern most ward in Trafford. It is the third largest ward in area size, and contains the Trafford Park Industrial Estate. The majority of population are located within the ward's southern edge. The residential neighbourhoods within this area include Lostock to the west, the northern tip of Stretford in the south, together with Gorse Hill itself, straddling its Chester Road spine in the south eastern edge of the ward. The ward is home to the famous Manchester United Football Club as well as Trafford Town Hall. The Media City development located on the Salford side of the Canal involving the BBC is generating significant development on the Trafford side, and Gorse Hill is also home to the iconic Coronation Street studio. The area has also benefitted from a new housing development and shops in the Lostock area. Remaining Lostock Fair Share funding was allocated to Asset Based Community Development (ABCD). Trafford Park and Humphrey Park railway stations serve the ward for commuting to both Manchester and Liverpool."},

      "Ecclesall":{slugName:"Ecclesall", description:"Hale Barns lies at the southern tip of the Borough. It is bounded to the east by the M56, to the south by the River Bollin, by the residential areas of Altrincham to the west and Newhall Green to the north. The ward contains a large amount of agricultural land including two private golf courses. There is also a number of private sports clubs within the ward providing facilities for tennis, bowling and football. It is generally considered to be an affluent ward in the top 10% wealthiest areas in England. Hale Barns has a good motorway network and is convenient for Manchester Airport. The ward is diverse in nature and is home to large Jewish and Muslim community groups."},

      "Firth Park":{slugName:"Firth_Park", description:"TO DO, TO DO"},

      "Fulwood":{slugName:"Fulwood", description:"TO DO, TO DO"},

      "Gleadless Valley":{slugName:"Gleadless_Valley", description:"TO DO, TO DO"},

      "Graves Park":{slugName:"Graves_Park", description:"TO DO, TO DO"},

      "Hillsborough":{slugName:"Hillsborough", description:"Hillsborough is the retail, leisure and transport hub of north-west Sheffield, connected by Supertram, bus and dual carriageway to the rest of the city.  Hillsborough has the largest suburban shopping centre in South Yorkshire and a Town Centre Strategy has been developed to improve the facilities. There is an historic park, Sheffield Wednesday Football Ground, Hillsborough Leisure Centre, Owlerton Stadium and the Hillsborough Arena Sports Association."},

      "Manor Castle":{slugName:"Manor_Castle", description:"TO DO, TO DO - Densely populated ward."},

      "Mosborough":{slugName:"Mosborough", description:"TO DO, TO DO - primarily a residential area in the south of the Borough. It is bounded to the west by the Bridgewater Canal and to the north by Baguley Brook. To the east are residential areas and to the south the main A560 road and Altrincham Golf Course. On the ward border is the busy Timperley district shopping centre. The south of the ward is more affluent than the north of the ward. The ward ranks within the top 500 of the least deprived wards in the country."},

      "Nether Edge and Sharrow":{slugName:"Nether_Edge_and_Sharrow", description:"TO DO, TO DO - Situated in the heart of the northern part of the Borough. It is split into three residential areas by the M60 motorway and a railway line. The Mersey Valley and the River Mersey form the southern boundary, with the residential areas of Stretford to the east and Flixton to the west. Within the ward are Urmston Town Centre and one of the five cemeteries of the Borough."},

      "Park and Arbourthorne":{slugName:"Park_and_Arbourthorne", description:"TO DO, TO DO - Village ward is on the eastern boundary of the Borough adjoining Manchester along Brooklands Road. To the south are Timperley wedge and the Bollin Valley and to the west the residential area of Timperley. Within the ward is the regeneration area of Broomwood, which contains a variety of greenspaces including Brooks Drive which runs from the A560 roundabout through the ward and forms part of a linear walkway and cycleway to link through to Davenport Green. Whilst the ward is fairly affluent it has pockets which face significant challenges."},
      
      "Richmond":{slugName:"Richmond", description:"Village ward is on the eastern boundary of the Borough adjoining Manchester along Brooklands Road. To the south are Timperley wedge and the Bollin Valley and to the west the residential area of Timperley. Within the ward is the regeneration area of Broomwood, which contains a variety of greenspaces including Brooks Drive which runs from the A560 roundabout through the ward and forms part of a linear walkway and cycleway to link through to Davenport Green. Whilst the ward is fairly affluent it has pockets which face significant challenges."},
      
      "Shiregreen and Brightside":{slugName:"Shiregreen_and_Brightside", description:"TO DO, TO DO - Village ward is on the eastern boundary of the Borough adjoining Manchester along Brooklands Road. To the south are Timperley wedge and the Bollin Valley and to the west the residential area of Timperley. Within the ward is the regeneration area of Broomwood, which contains a variety of greenspaces including Brooks Drive which runs from the A560 roundabout through the ward and forms part of a linear walkway and cycleway to link through to Davenport Green. Whilst the ward is fairly affluent it has pockets which face significant challenges."},
      
      "Southey":{slugName:"Southey", description:"The Southey ward includes the districts of Fox Hill, New Parsons Cross, Southey, Wadsley Bridge and part of Old Parsons Cross. The Southey ward is part of one of the most deprived areas of the city. Much of it is within the top 10% most deprived areas in the country and some of the area within the top 5% most severely deprived.  It has been the focus of regeneration programmes including Southey Owlerton Area Regeneration (SOAR) and Housing Market Renewal schemes."},
      
      "Stannington":{slugName:"Stannington", description:"TO DO, TO DO - Village ward is on the eastern boundary of the Borough adjoining Manchester along Brooklands Road. To the south are Timperley wedge and the Bollin Valley and to the west the residential area of Timperley. Within the ward is the regeneration area of Broomwood, which contains a variety of greenspaces including Brooks Drive which runs from the A560 roundabout through the ward and forms part of a linear walkway and cycleway to link through to Davenport Green. Whilst the ward is fairly affluent it has pockets which face significant challenges."},
      
      "Stocksbridge and Upper Don":{slugName:"Stocksbridge_and_Upper_Don", description:"TO DO, TO DO - Village ward is on the eastern boundary of the Borough adjoining Manchester along Brooklands Road. To the south are Timperley wedge and the Bollin Valley and to the west the residential area of Timperley. Within the ward is the regeneration area of Broomwood, which contains a variety of greenspaces including Brooks Drive which runs from the A560 roundabout through the ward and forms part of a linear walkway and cycleway to link through to Davenport Green. Whilst the ward is fairly affluent it has pockets which face significant challenges."},
      
      "Walkley":{slugName:"Walkley", description:"TO DO, TO DO - Village ward is on the eastern boundary of the Borough adjoining Manchester along Brooklands Road. To the south are Timperley wedge and the Bollin Valley and to the west the residential area of Timperley. Within the ward is the regeneration area of Broomwood, which contains a variety of greenspaces including Brooks Drive which runs from the A560 roundabout through the ward and forms part of a linear walkway and cycleway to link through to Davenport Green. Whilst the ward is fairly affluent it has pockets which face significant challenges."},
        
        "West Ecclesfield":{slugName:"West_Ecclesfield", description:"TO DO, TO DO - Village ward is on the eastern boundary of the Borough adjoining Manchester along Brooklands Road. To the south are Timperley wedge and the Bollin Valley and to the west the residential area of Timperley. Within the ward is the regeneration area of Broomwood, which contains a variety of greenspaces including Brooks Drive which runs from the A560 roundabout through the ward and forms part of a linear walkway and cycleway to link through to Davenport Green. Whilst the ward is fairly affluent it has pockets which face significant challenges."},
        
        "Woodhouse":{slugName:"Woodhouse", description:"TO DO, TO DO - Village ward is on the eastern boundary of the Borough adjoining Manchester along Brooklands Road. To the south are Timperley wedge and the Bollin Valley and to the west the residential area of Timperley. Within the ward is the regeneration area of Broomwood, which contains a variety of greenspaces including Brooks Drive which runs from the A560 roundabout through the ward and forms part of a linear walkway and cycleway to link through to Davenport Green. Whilst the ward is fairly affluent it has pockets which face significant challenges."}
      }

      document.getElementById("bar").innerHTML='<div class="eight0" ><object width="70%" type="image/svg+xml" data="https://sheffwardprofiler.azurewebsites.net/spatial//ward_plots/' + nameObj[d.area_name]["slugName"] + '.svg"></object></div>'
      document.getElementById("description").innerHTML="<h3>" + d.area_name + "</h3><p>" + nameObj[d.area_name]["description"] + "</p>"
    }

    function showBestFitMap(){
      document.getElementById("svgBFM").innerHTML='<img width="100%" src="https://sheffwardprofiler.azurewebsites.net/spatial/sheffield_best-fit_wards.png"></img>'
      document.getElementById("bestFitMap").classList.add("visible");
    }

    function removeBestFitMap(){
      document.getElementById("svgBFM").innerHTML=''
      document.getElementById("bestFitMap").classList.remove("visible");
    }

    function readURLData(){
      var theme=labGetQryStrValByKey("theme")
      var dataset=labGetQryStrValByKey("name")
      if (typeof theme  == "string"){
        for (var i = 0; i < themeUrls.length; i++) {
          if(theme == themeUrls[i].theme){
            document.getElementById("selectTheme").selectedIndex = i;
            document.getElementById('selectTheme').value = i.toString();
            d3.csv(themeUrls[i].url, function(error, data) {
              currentDatasetList=data;
              for (var j = 0; j < data.length; j++) {
                if(dataset == data[j].indicator){
                  currentTheme=theme
                  callChoro(j)
                  popSelect(data,'dataset','callChoro')
                  document.getElementById("datasetSelect").selectedIndex = j;
                  document.getElementById('datasetSelect').value = j.toString();
                  break;
                }
              }
            })
            break;
          }
        }

      }else{
        initialPage()
      }
    }


   </script>
   </body>
   </html>
